set(CMAKE_CXX_STANDARD_REQUIRED ON)
set(CMAKE_CXX_EXTENSIONS OFF)

if (CMAKE_CXX_COMPILER_ID STREQUAL "MSVC")
  # warning level 4
  add_compile_options(/W4)
endif()

if (CMAKE_CXX_COMPILER_ID STREQUAL "GNU")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

if (CMAKE_CXX_COMPILER_ID STREQUAL "Clang")
  add_compile_options(-Wall -Wextra -Wpedantic)
endif()

if(NOT TARGET tests)
  add_custom_target(tests)
endif()

set(PREFIX "boost_container_")
set(LINK_LIBRARIES Boost::container Boost::included_test_exec_monitor)

function(boost_container_add_test name source)
  set(pname "${PREFIX}${name}")
  add_executable(${pname} ${source})
  target_link_libraries(${pname} ${LINK_LIBRARIES})
  add_test(NAME ${pname} COMMAND ${pname})
  add_dependencies(tests ${pname})
endfunction()

boost_container_add_test(allocator_traits_test allocator_traits_test.cpp)
boost_container_add_test(alloc_basic_test alloc_basic_test.cpp)
boost_container_add_test(alloc_full_test alloc_full_test.cpp)
boost_container_add_test(boost_iterator_comp_test boost_iterator_comp_test.cpp)
boost_container_add_test(common_iterator_test common_iterator_test.cpp)
boost_container_add_test(copy_move_algo_test copy_move_algo_test.cpp)
boost_container_add_test(deque_options_test deque_options_test.cpp)
boost_container_add_test(deque_test deque_test.cpp)
boost_container_add_test(devector_options_test devector_options_test.cpp)
boost_container_add_test(devector_test devector_test.cpp)
boost_container_add_test(explicit_inst_deque_test explicit_inst_deque_test.cpp)
boost_container_add_test(explicit_inst_devector_test explicit_inst_devector_test.cpp)
boost_container_add_test(explicit_inst_flat_map_test explicit_inst_flat_map_test.cpp)
boost_container_add_test(explicit_inst_flat_set_test explicit_inst_flat_set_test.cpp)
boost_container_add_test(explicit_inst_list_test explicit_inst_list_test.cpp)
boost_container_add_test(explicit_inst_map_test explicit_inst_map_test.cpp)
boost_container_add_test(explicit_inst_set_test explicit_inst_set_test.cpp)
boost_container_add_test(explicit_inst_slist_test explicit_inst_slist_test.cpp)
boost_container_add_test(explicit_inst_small_vector_test explicit_inst_small_vector_test.cpp)
boost_container_add_test(explicit_inst_stable_vector_test explicit_inst_stable_vector_test.cpp)
boost_container_add_test(explicit_inst_static_vector_test explicit_inst_static_vector_test.cpp)
boost_container_add_test(explicit_inst_string_test explicit_inst_string_test.cpp)
boost_container_add_test(explicit_inst_vector_test explicit_inst_vector_test.cpp)
boost_container_add_test(flat_map_adaptor_test flat_map_adaptor_test.cpp)
boost_container_add_test(flat_map_test flat_map_test.cpp)
boost_container_add_test(flat_set_adaptor_test flat_set_adaptor_test.cpp)
boost_container_add_test(flat_set_test flat_set_test.cpp)
boost_container_add_test(flat_tree_test flat_tree_test.cpp)
boost_container_add_test(global_resource_test global_resource_test.cpp)
boost_container_add_test(insert_vs_emplace_test insert_vs_emplace_test.cpp)
boost_container_add_test(list_test list_test.cpp)
boost_container_add_test(map_test map_test.cpp)
boost_container_add_test(memory_resource_test memory_resource_test.cpp)
boost_container_add_test(monotonic_buffer_resource_test monotonic_buffer_resource_test.cpp)
boost_container_add_test(node_handle_test node_handle_test.cpp)
boost_container_add_test(null_iterators_test null_iterators_test.cpp)
boost_container_add_test(pair_test pair_test.cpp)
boost_container_add_test(pmr_deque_test pmr_deque_test.cpp)
boost_container_add_test(pmr_devector_test pmr_devector_test.cpp)
boost_container_add_test(pmr_flat_map_test pmr_flat_map_test.cpp)
boost_container_add_test(pmr_flat_set_test pmr_flat_set_test.cpp)
boost_container_add_test(pmr_list_test pmr_list_test.cpp)
boost_container_add_test(pmr_map_test pmr_map_test.cpp)
boost_container_add_test(pmr_set_test pmr_set_test.cpp)
boost_container_add_test(pmr_slist_test pmr_slist_test.cpp)
boost_container_add_test(pmr_small_vector_test pmr_small_vector_test.cpp)
boost_container_add_test(pmr_stable_vector_test pmr_stable_vector_test.cpp)
boost_container_add_test(pmr_string_test pmr_string_test.cpp)
boost_container_add_test(pmr_vector_test pmr_vector_test.cpp)
boost_container_add_test(polymorphic_allocator_test polymorphic_allocator_test.cpp)
boost_container_add_test(resource_adaptor_test resource_adaptor_test.cpp)
boost_container_add_test(scoped_allocator_adaptor_test scoped_allocator_adaptor_test.cpp)
boost_container_add_test(scoped_allocator_usage_test scoped_allocator_usage_test.cpp)
boost_container_add_test(set_test set_test.cpp)
boost_container_add_test(slist_test slist_test.cpp)
boost_container_add_test(small_vector_options_test small_vector_options_test.cpp)
boost_container_add_test(small_vector_test small_vector_test.cpp)
boost_container_add_test(stable_vector_test stable_vector_test.cpp)
boost_container_add_test(static_vector_options_test static_vector_options_test.cpp)
boost_container_add_test(static_vector_test static_vector_test.cpp)
boost_container_add_test(string_test string_test.cpp)
boost_container_add_test(string_view_compat_test string_view_compat_test.cpp)
boost_container_add_test(synchronized_pool_resource_test synchronized_pool_resource_test.cpp)
boost_container_add_test(throw_exception_test throw_exception_test.cpp)
boost_container_add_test(tree_test tree_test.cpp)
boost_container_add_test(unsynchronized_pool_resource_test unsynchronized_pool_resource_test.cpp)
boost_container_add_test(uses_allocator_test uses_allocator_test.cpp)
boost_container_add_test(vector_options_test vector_options_test.cpp)
boost_container_add_test(vector_test vector_test.cpp)
